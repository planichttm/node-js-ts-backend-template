# Text Generation UseCase

## Overview

The Text Generation UseCase provides a simple interface to generate text using local Ollama models. It represents a core business capability of the application and is designed following clean architecture principles to maintain separation of concerns.

## Directory Structure

- **`generate-text.usecase.ts`**: Core business logic for text generation
- **`README.md`**: This documentation file

## Key Components

### GenerateTextUseCase

This UseCase encapsulates the complete text generation workflow:
- Validates input parameters and enforces business rules
- Coordinates with the OllamaService for model interaction
- Transforms raw API responses into structured, domain-specific objects
- Handles error conditions and edge cases
- Maintains separation from HTTP and infrastructure concerns

The UseCase operates solely on domain objects and doesn't have direct knowledge of HTTP requests, responses, or database specifics.

## Flow of Operations

1. Receives a validated TextGenerationRequest from the controller
2. Validates business rules (e.g., prompt must be present)
3. Prepares parameters for the Ollama service call
4. Delegates to OllamaService for the actual API interaction
5. Processes and validates the service response
6. Returns a structured TextGenerationResult or throws appropriate errors

## Usage Example

```typescript
import { generateTextUseCase } from './text-generation-usecase/generate-text.usecase';

// Basic usage
const result = await generateTextUseCase.execute({
  prompt: "Explain the benefits of clean architecture"
});

// Advanced usage with all parameters
const result = await generateTextUseCase.execute({
  prompt: "Explain the benefits of clean architecture",
  model: "gemma2:7b",
  temperature: 0.7,
  authToken: "your-auth-token"
});

console.log(result);
// {
//   generatedText: "Clean architecture offers several benefits...",
//   model: "gemma2:7b",
//   prompt: "Explain the benefits of clean architecture"
// }
```

## Input Parameters

The UseCase accepts a `TextGenerationRequest` object with the following properties:

| Parameter     | Type    | Required | Description                                  | Default    |
|---------------|---------|----------|----------------------------------------------|------------|
| prompt        | string  | Yes      | The text prompt to generate content from     | -          |
| model         | string  | No       | The Ollama model to use                      | "gemma2:7b" |
| temperature   | number  | No       | Creativity temperature (0.0 to 1.0)          | 0.7        |
| authToken     | string  | No       | Authentication token for secured APIs        | undefined  |

## Response Format

The UseCase returns a `TextGenerationResult` object with:

| Property      | Type    | Description                                     |
|---------------|---------|-------------------------------------------------|
| generatedText | string  | The complete text generated by the model        |
| model         | string  | The model used for generation                   |
| prompt        | string  | The original prompt (for reference)             |

## Error Handling

The UseCase implements robust error handling:

- **Validation Errors**: Thrown when required parameters are missing
- **Service Errors**: Propagated from the OllamaService when API calls fail
- **Response Errors**: Thrown when the API returns invalid or unexpected data

All errors are logged with appropriate context and metadata to facilitate troubleshooting.

## Dependencies

- **OllamaService**: Handles communication with the Ollama API
- **Logger**: Provides structured logging throughout the process

## Best Practices

- Keep this UseCase focused on text generation only
- Add new UseCases for related but different functionality
- Maintain independence from HTTP and database concerns
- Use dependency injection for easier testing
- Add comprehensive unit tests for all edge cases